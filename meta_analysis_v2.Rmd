---
title: "lit_review"
author: "Moeka"
date: "2023-10-09"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(ggplot2)
library(ggpmisc)

library(tidyr)
library(dplyr)
library(broom)
library(gridExtra)
library(stringr)
library(data.table)
library(forestmangr)
library(googlesheets4)
library(ggpubr)

library(rJava)
library(glmulti)
library(metafor)

library(purrr)
library(lme4)
library(patchwork)
library(stringr)

library(rlang)
```

```{r read & clean dataset}
lit_raw <- 
  readxl::read_xlsx("G:/My Drive/Research/Projects/lit_review/data/lit_review_2025.xlsx", sheet = "data_raw")

summary(lit_raw)

# numeric values
lit <- 
  lit_raw %>%
  mutate(across(Latitude:MAP, as.numeric)) %>% 
  mutate(across(C_rep_n:T_BGB, as.numeric)) %>% 
  mutate(Wt = T_rep_n * C_rep_n / (T_rep_n + C_rep_n))

summary(lit)

# for SD
lit %>% 
  select(where(is.numeric)) %>% 
  summarise(across(everything(), ~ sd(.x, na.rm = T))) %>% 
  View()
```


```{r Effect size}
# Identify treatment columns excluding "T_rep_n"
treatment_cols <- setdiff(grep("^T_", names(lit), value = TRUE), "T_rep_n")

# Compute log effect size
lit_effect <- lit %>%
  mutate(across(all_of(treatment_cols), 
                ~ log(. / lit[[sub("T_", "C_", cur_column())]]), 
                .names = "ln_{.col}")) %>%
  rename_with(~ sub("^ln_T_", "ln_", .), starts_with("ln_T_")) %>%
  mutate(across(starts_with("ln_"), ~ replace(., is.infinite(.), NA)))

#write.csv(lit_effect, "G:/My Drive/Research/Projects/lit_review/Data/Ln_RR_raw.csv", row.names = F)
```

```{r mixed effects model for vars}
# Management type
CC <- lit_effect %>% filter(Management_type == "Clearcut")
PB <- lit_effect %>% filter(Management_type == "Prescribed burn")
TH <- lit_effect %>% filter(Management_type == "Thinning")


run_boot_lmer <- function(data, response_var) {
  # Remove NA/NaN/Inf from response before modeling
  data_clean <- data %>%
    filter(!is.na(.data[[response_var]]),
           is.finite(.data[[response_var]]))

  # Compute study and observation counts
  n_study <- data_clean %>% pull(ID) %>% n_distinct()
  n_obs <- nrow(data_clean)

  # Initialize result with NAs
  result <- data.frame(
    Response = response_var,
    Management = unique(data$Management_type),
    n_study = n_study,
    n_obs = n_obs,
    Intercept = NA_real_,
    Intercept_Lower = NA_real_,
    Intercept_Upper = NA_real_,
    Random_SD_Lower = NA_real_,
    Random_SD_Upper = NA_real_,
    Residual_SD_Lower = NA_real_,
    Residual_SD_Upper = NA_real_
  )

  # Only run model if enough studies
  if (n_study > 1) {
    tryCatch({
      model <- lmer(
        as.formula(paste(response_var, "~ 1 + (1|ID)")),
        weights = Wt,
        data = data_clean
      )
      
      ci <- suppressMessages(confint(model, method = "boot", level = 0.95))
      intercept <- fixef(model)["(Intercept)"]
      
      result$Intercept <- intercept
      result$Intercept_Lower <- ci["(Intercept)", 1]
      result$Intercept_Upper <- ci["(Intercept)", 2]
      result$Random_SD_Lower <- ci[".sig01", 1]
      result$Random_SD_Upper <- ci[".sig01", 2]
      result$Residual_SD_Lower <- ci[".sigma", 1]
      result$Residual_SD_Upper <- ci[".sigma", 2]
    }, error = function(e) {
      message(paste("Model failed for", response_var, "-", e$message))
    })
  } else {
    message(paste("Skipping model for", response_var, "- not enough studies (n_study =", n_study, ")"))
  }

  return(result)
}


# Run function for each management type and response variable
Mng_types <- list(CC = CC, PB = PB, TH = TH)

Response_vars <- 
  lit_effect %>% 
  select(starts_with("ln_")) %>% 
  colnames() %>%
  setdiff(c("ln_Clay", "ln_Silt", "ln_Sand", "ln_DOC", "ln_DON"))  # only few studies reported these


results_list <- list()
for(mng in names(Mng_types)){
  for (resp in Response_vars) {
    results_list[[paste(mng, resp, sep = "_")]] <- run_boot_lmer(Mng_types[[mng]], resp)
  }
}
  
summary_table <- 
  bind_rows(results_list) %>% 
  mutate(
    across(Intercept:Intercept_Upper, 
           ~(exp(1) ^ (.) - 1) * 100,
           .names = "{.col}_pct_change")
        )
  
#write.csv(summary_table, "G:/My Drive/Research/Projects/lit_review/Data/Ln_RR_summary.csv", row.names = F)

#summary_table <- read.csv("G:/My Drive/Research/Projects/lit_review/Data/Ln_RR_summary.csv")
```


```{r effect size graph}

# Define variable groups
group_map <- c(
  "SR" = "Soil Respiration",
  "Ra" = "Soil Respiration",
  "Rh" = "Soil Respiration",
  "Ts" = "Soil Environment",
  "SM" = "Soil Environment",
  "BD" = "Soil Environment",
  "pH" = "Soil Environment",
  "SOC" = "Soil Environment",
  "SON" = "Soil Environment",
  "TC" = "Soil Environment",
  "TN" = "Soil Environment",
  "CN" = "Soil Environment",
  "FRB" = "Biomass",
  "CRB" = "Biomass",
  "FRP" = "Biomass",
  "CRP" = "Biomass",
  "AGB" = "Biomass",
  "BGB" = "Biomass",
  "LAI" = "Biomass",
  "LF" = "Biomass",
  "FF" = "Biomass",
  "MBC" = "Biomass",
  "MBN" = "Biomass"
)

# Define factor levels to control y-axis order
response_levels <- str_remove(rev(Response_vars), "^ln_")

# Step 1: Clean and assign groups
plot_df <- summary_table %>%
  filter(n_study > 2) %>%
  mutate(
    Response_clean = str_remove(Response, "^ln_"),
    color_group = case_when(
      Intercept_Lower_pct_change > 0 & Intercept_Upper_pct_change > 0 ~ "royalblue",
      Intercept_Lower_pct_change < 0 & Intercept_Upper_pct_change < 0 ~ "red2",
      TRUE ~ "black"
    ),
    background_group = group_map[Response_clean],
    background_group = ifelse(is.na(background_group), "Other", background_group),
    Response_clean = factor(Response_clean, levels = response_levels)
  )

# Step 2: Create row-level shading using ymin/ymax
rect_df <- plot_df %>%
  distinct(Response_clean, background_group) %>%
  mutate(
    y = as.numeric(Response_clean),
    ymin = y - 0.5,
    ymax = y + 0.5,
    fill = case_when(
      background_group == "Soil Respiration" ~ "plum",
      background_group == "Soil Environment" ~ "khaki3",
      background_group == "Biomass" ~ "lightgreen",
      TRUE ~ "white"
    )
  )

# Step 3: Final plot
ggplot(plot_df) +
  # Horizontal background shading
  geom_rect(
    data = rect_df,
    aes(ymin = ymin, ymax = ymax, xmin = -Inf, xmax = Inf, fill = fill),
    inherit.aes = FALSE,
    alpha = 0.2
  ) +
  geom_point(aes(
    x = Intercept_pct_change,
    y = Response_clean,
    color = color_group
  ), size = 5) +
  geom_errorbarh(aes(
    y = Response_clean,
    xmin = Intercept_Lower_pct_change,
    xmax = Intercept_Upper_pct_change,
    color = color_group
  ), height = 0.2, linewidth = 1.5) +
  geom_vline(xintercept = 0, color = "black", size = 1.5, alpha = 0.4) +
  geom_text(aes(
    x = Intercept_Upper_pct_change + 20,
    y = Response_clean,
    label = paste0(n_obs, " (", n_study, ")")
  ),
  vjust = 0.5, size = 4) +
  scale_color_identity() +
  scale_fill_identity() +
  facet_wrap(~ Management, nrow = 1, ncol = 4) +
  xlab(expression("Effect Size (%)")) +
  theme_classic2() +
  theme(
    axis.title.x = element_text(size = 15),
    axis.text.x = element_text(size = 15),
    axis.title.y = element_blank(),
    axis.text.y = element_text(size = 15),
    strip.text = element_text(size = 15),
    panel.border = element_rect(colour = "black", fill = NA, linewidth = 0.1)
  ) +
  facet_wrap(~ factor(Management, levels = c("Clearcut", "Thinning", "Prescribed burn")), nrow = 1, ncol = 4)

```

```{r individual difference}
# under CC, ln_Rh vs ln_Ra
CC_long <- CC %>%
    select(ID, Wt, ln_Ra, ln_Rh) %>%
    pivot_longer(c(ln_Ra, ln_Rh), names_to = "Component", values_to = "ln_value") %>%
    mutate(Component = factor(Component))

m_diff <- lmerTest::lmer(ln_value ~ Component + (1 | ID), weights = Wt, data = CC_long)
summary(m_diff) # Intercept shows ln_Ra, Componentln_Rh is the diff
confint(m_diff)  # gives 95% CI for the Ra vs Rh difference

# PB
PB_long <- PB %>%
    select(ID, Wt, ln_Ra, ln_Rh) %>%
    pivot_longer(c(ln_Ra, ln_Rh), names_to = "Component", values_to = "ln_value") %>%
    mutate(Component = factor(Component))

m_diff_PB <- lmerTest::lmer(ln_value ~ Component + (1 | ID), weights = Wt, data = PB_long)
summary(m_diff_PB) # Intercept shows ln_Ra, Componentln_Rh is the diff
confint(m_diff_PB)  # gives 95% CI for the Ra vs Rh difference

```

What can be added to the predictive models?
Which models should I use?
Consider removing redundant vars.

```{r select predictors- missing ratios}
get_non_na_summary <- function(data, var2) {
  data %>%
    select(c(ID:Repeat, starts_with("ln_"))) %>%
    filter(!is.na(.data[[var2]])) %>%
    summarise(across(Latitude:ln_BGB, ~ {
      if (is.character(.)) {
        100 * sum(is.na(.) | . == "NA") / n()
      } else {
        100 * sum(is.na(.)) / n()
      }
    }))
}

vars <- c("ln_SR", "ln_Rh", "ln_Ra")

NA_ratios <- 
  cross_df(list(Mng = names(Mng_types), LRR = vars)) %>%
  mutate(summary = map2(Mng_types[Mng], LRR, get_non_na_summary)) %>%
  unnest(summary) %>% 
  arrange(Mng)

#write.csv(NA_ratios, "G:/My Drive/Research/Projects/lit_review/Data/NA_ratios.csv", row.names = F)
```

corr 

```{r test corr basic}
corr_plt <- function(df, var1, var2){
  ggplot(df, aes({{var1}}, {{var2}})) +  
  geom_point() +
  theme_bw() +
  geom_smooth(method = lm, se = T) + 
  stat_poly_eq(use_label(c("eq", "R2", "P")))
} 
  

#ggplot(lit_effect) + geom_point(aes(Latitude, Longitude))
p1 <- corr_plt(lit_effect, Latitude, MAT)
p2 <- corr_plt(lit_effect, Latitude, MAP)
p3 <- corr_plt(lit_effect, Longitude, MAT)
p4 <- corr_plt(lit_effect, Longitude, MAP)
p5 <- corr_plt(lit_effect, MAT, MAP)

ggarrange(p1, p2, p3, p4, p5)

```


```{r lmer test}
library(lmerTest)

anova_result_df <- function(model){
  
  a <- anova(model)
  df <- as.data.frame(
    a, row.names = make.unique(rownames(a))
  ) %>% 
    tibble::rownames_to_column("term")
  
  
  df$model <- deparse(substitute(model))
  
  return(df)
}
  

#CC_SR
m_CC_SR <- lmerTest::lmer(
        ln_SR ~ as.factor(Forest_type) + as.factor(Leaf_habit) + as.factor(Season) + 
          scale(MAP) + (1|ID),
        weights = Wt,
        data = CC
      )
summary(m_CC_SR)
lmer_CC_SR <- anova_result_df(m_CC_SR)

#CC_Rh
m_CC_Rh <- lmerTest::lmer(
        ln_Rh ~ as.factor(Leaf_habit) + 
          scale(Latitude) + scale(MAT) + scale(MAP) + (1|ID),
        weights = Wt,
        data = CC
      )
summary(m_CC_Rh)
lmer_CC_Rh <- anova_result_df(m_CC_Rh)

#CC_Ra
m_CC_Ra <- lmerTest::lmer(
        ln_Ra ~ as.factor(Forest_type) + as.factor(Leaf_habit) + as.factor(Severity_level) 
        + scale(MAT) + scale(Time_since) + (1|ID),
        weights = Wt,
        data = CC
      )
summary(m_CC_Ra)
lmer_CC_Ra <- anova_result_df(m_CC_Ra)

#PB_SR
m_PB_SR <- lmerTest::lmer(
        ln_SR ~ as.factor(Repeat) + (1|ID),
        weights = Wt,
        data = PB
      )
summary(m_PB_SR)
lmer_PB_SR <- anova_result_df(m_PB_SR)


#TH_SR
m_TH_SR <- lmerTest::lmer(
        ln_SR ~ as.factor(Climate_zone) + as.factor(Leaf_habit) + as.factor(Severity_level) + as.factor(Repeat) + 
          scale(Latitude) + (1|ID),
        weights = Wt,
        data = TH
      )
summary(m_TH_SR)
lmer_TH_SR <- anova_result_df(m_TH_SR)

#TH_Rh
m_TH_Rh <- lmerTest::lmer(
        ln_Rh ~ as.factor(Climate_zone) + as.factor(Season) + (1|ID),
        weights = Wt,
        data = TH
      )
summary(m_TH_Rh)
lmer_TH_Rh <- anova_result_df(m_TH_Rh)

#CC_Ra
m_TH_Ra <- lmerTest::lmer(
        ln_Ra ~ as.factor(Climate_zone) + 
        scale(Latitude)+ scale(MAP) + (1|ID),
        weights = Wt,
        data = TH
      )
summary(m_TH_Ra)
lmer_TH_Ra <- anova_result_df(m_TH_Ra)

# combine them all
lmer_result_summary <- 
  bind_rows(list(lmer_CC_SR, lmer_CC_Rh, lmer_CC_Ra,
                 lmer_PB_SR,
                 lmer_TH_SR, lmer_TH_Rh, lmer_TH_Ra)) %>% 
  relocate(model)

#xlsx::write.xlsx(lmer_result_summary, "G:/My Drive/Research/Projects/lit_review/Data/lmer_result.xlsx", row.names = F)
```



```{r corr every vars}
env_var <- setdiff(Response_vars, vars)
management_types <- c("CC", "PC", "PB", "TH")

# CC
plot_list_CC <- list()

for (res in vars) {
    for (var in env_var) {
        plot_name <- paste(res, var, sep = "_vs_")
        
        plot_list_CC[[plot_name]] <- ggplot_templete(CC, !!sym(var), !!sym(res))
    }
}
# Break the plot list into 3 groups of 25
plot_chunks_CC <- split(plot_list_CC, ceiling(seq_along(plot_list_CC) / 25))

# View each page
for (i in seq_along(plot_chunks_CC)) {
    print(wrap_plots(plot_chunks_CC[[i]], ncol = 5) + plot_annotation(title = "CC"))
}

# PB
plot_list_PB <- list()

for (res in vars) {
    for (var in env_var) {
        plot_name <- paste(res, var, sep = "_vs_")
        
        plot_list_PB[[plot_name]] <- ggplot_templete(PB, !!sym(var), !!sym(res))
    }
}
# Break the plot list into 3 groups of 25
plot_chunks_PB <- split(plot_list_PB, ceiling(seq_along(plot_list_PB) / 25))

# View each page
for (i in seq_along(plot_chunks_PB)) {
    print(wrap_plots(plot_chunks_PB[[i]], ncol = 5) + plot_annotation(title = "PB"))
}


# TH
plot_list_TH <- list()

for (res in vars) {
    for (var in env_var) {
        plot_name <- paste(res, var, sep = "_vs_")
        
        plot_list_TH[[plot_name]] <- ggplot_templete(TH, !!sym(var), !!sym(res))
    }
}
# Break the plot list into 3 groups of 25
plot_chunks_TH <- split(plot_list_TH, ceiling(seq_along(plot_list_TH) / 25))

# View each page
for (i in seq_along(plot_chunks_TH)) {
    print(wrap_plots(plot_chunks_TH[[i]], ncol = 5) + plot_annotation(title = "TH"))
}
```


```{r corr ind function}
# Function to prepare plot
ggplot_responses <- function(data, predictor_var) {
  # Reshape the data to long format
  long_data <- data %>%
    select({{predictor_var}}, ln_SR, ln_Rh, ln_Ra, Wt) %>%
    pivot_longer(cols = c(ln_SR, ln_Rh, ln_Ra), names_to = "Component", values_to = "lnRR") %>%
    mutate(Component = factor(Component))

  # Convert predictor variable to string
  pred_str <- rlang::as_name(rlang::enquo(predictor_var))

  # Get p-values per Component
  model_info <- long_data %>%
    group_by(Component) %>%
    group_modify(~ {
      model <- lm(reformulate(pred_str, response = "lnRR"), data = .x)
      tidy(model) %>%
        filter(term == pred_str) %>%
        mutate(significant = p.value < 0.05)
    }) %>%
    select(Component, p.value, significant)

  # Join significance info back to the data
  long_data <- long_data %>%
    left_join(model_info, by = "Component")

  # Plot
  ggplot(long_data, aes(x = .data[[pred_str]], y = lnRR, color = Component, weight = Wt)) +
    geom_hline(yintercept = 0, color = "black", size = 1.2, alpha = 0.4) +
    geom_vline(xintercept = 0, color = "black", size = 1.2, alpha = 0.4) +
    geom_point(aes(size = Wt), shape = 1, stroke = 1.5, alpha = 0.8) +
    geom_smooth(
      data = filter(long_data, significant),
      method = "lm", se = FALSE,
      aes(group = Component),
      show.legend = FALSE,
      size = 1.5
    ) +
    stat_poly_eq(
      data = 
        filter(long_data, significant) %>% 
        mutate(label_y = case_when(
          Component == "ln_SR" ~ 1.5,
          Component == "ln_Rh" ~ 1.0,
          Component == "ln_Ra" ~ 0.5
        )),
      aes(label = after_stat(
        paste(eq.label, "*\"  ,  \"~", 
        adj.rr.label, "*\"  ,  \"~", 
        p.value.label, sep = ""))
        ),
      formula = y ~ x,
      parse = TRUE,
      size = 5.5,
      coef.digits = 2,
      p.digits = 2,
      label.x.npc = "right",
      label.y.npc = "bottom",
      method = "lm"
     ) +
    theme_classic() +
    scale_color_manual(values = c("ln_SR" = "blue", "ln_Rh" = "tomato", "ln_Ra" = "forestgreen")) +
    theme(
      axis.title.x = element_text(size = 20),
      axis.text.x = element_text(size = 20),
      axis.title.y = element_text(size = 20),
      axis.text.y = element_text(size = 20),
      legend.position = "none",
      panel.border = element_rect(colour = "black", fill = NA, linewidth = .5)
    )
}
```

```{r corr ind applicatoin}  
corr_fig_dir <- "G:/My Drive/Research/Projects/lit_review/Fig/corr/"

#CC 
png(file = paste0(corr_fig_dir, "CC_lnTs.png"), width = 850, height = 640)
CC_Ts <- ggplot_responses(CC, ln_Ts)
print(CC_Ts)
dev.off()

png(file = paste0(corr_fig_dir, "CC_lnSM.png"), width = 530, height = 420)
CC_SM <- ggplot_responses(CC, ln_SM)
print(CC_SM)
dev.off()

png(file = paste0(corr_fig_dir, "CC_lnSOC.png"), width = 530, height = 420)
CC_SOC <- ggplot_responses(CC, ln_SOC)
print(CC_SOC)
dev.off()

png(file = paste0(corr_fig_dir, "CC_lnFRB.png"), width = 530, height = 420)
CC_FRB <- ggplot_responses(CC, ln_FRB)
print(CC_FRB)
dev.off()


CC_LF <- ggplot_responses(CC, ln_LF)

png(file = paste0(corr_fig_dir, "CC_lnLAI.png"), width = 530, height = 420)
CC_LAI <- ggplot_responses(CC, ln_LAI)
print(CC_LAI)
dev.off()

png(file = paste0(corr_fig_dir, "CC_lnMBC.png"), width = 530, height = 420)
CC_MBC <- ggplot_responses(CC, ln_MBC)
print(CC_MBC)
dev.off()

CC_TC <- ggplot_responses(CC, ln_TC)
CC_TN <- ggplot_responses(CC, ln_TN)
CC_LAI <- ggplot_responses(CC, ln_LAI)
CC_AGB <- ggplot_responses(CC, ln_AGB)

# TH

png(file = paste0(corr_fig_dir, "TH_lnTs.png"), width = 530, height = 420)
TH_Ts <- ggplot_responses(TH, ln_Ts)
print(TH_Ts)
dev.off()

png(file = paste0(corr_fig_dir, "TH_lnSM.png"), width = 530, height = 420)
TH_SM <- ggplot_responses(TH, ln_SM)
print(TH_SM)
dev.off()

png(file = paste0(corr_fig_dir, "TH_ln_FRB.png"), width = 530, height = 420)
TH_FRB <- ggplot_responses(TH, ln_FRB)
print(TH_FRB)
dev.off()

png(file = paste0(corr_fig_dir, "TH_ln_FF.png"), width = 530, height = 420)
TH_FF <- ggplot_responses(TH, ln_FF)
print(TH_FF)
dev.off()

TH_SOC <- ggplot_responses(TH, ln_SOC)
TH_LF <- ggplot_responses(TH, ln_LF)

TH_TC <- ggplot_responses(TH, ln_TC)
TH_TN <- ggplot_responses(TH, ln_TN)
TH_LAI <- ggplot_responses(TH, ln_LAI)
TH_AGB <- ggplot_responses(TH, ln_AGB)

# PB
png(file = paste0(corr_fig_dir, "PB_lnTs.png"), width = 530, height = 420)
PB_Ts <- ggplot_responses(PB, ln_Ts)
print(PB_Ts)
dev.off()

png(file = paste0(corr_fig_dir, "PB_lnSM.png"), width = 530, height = 420)
PB_SM <- ggplot_responses(PB, ln_SM)
print(PB_SM)
dev.off()

png(file = paste0(corr_fig_dir, "PB_ln_FRB.png"), width = 530, height = 420)
PB_FRB <- ggplot_responses(PB, ln_FRB)
print(PB_FRB)
dev.off()

png(file = paste0(corr_fig_dir, "PB_ln_FF.png"), width = 530, height = 420)
PB_FF <- ggplot_responses(PB, ln_FF)
print(PB_FF)
dev.off()

PB_SOC <- ggplot_responses(PB, ln_SOC)
PB_LF <- ggplot_responses(PB, ln_LF)

PB_TC <- ggplot_responses(PB, ln_TC)
PB_TN <- ggplot_responses(PB, ln_TN)
PB_LAI <- ggplot_responses(PB, ln_LAI)
PB_AGB <- ggplot_responses(PB, ln_AGB)

ggplot_responses(CC %>% filter(Residue == "Y"), ln_SM) + ggtitle("With Residues CC")
```

From here, comparison in categorical values

```{r categorical comparison ggplot}

cat_compare_plot <- function(df, xvar, xlabel, xlevels = NULL) {
  df <- df %>%
    mutate(
      !!xvar := if (!is.null(xlevels)) factor(.data[[xvar]], levels = xlevels) else .data[[xvar]]
    )

  ggplot(df) + 
    geom_point(aes(x = .data[[xvar]], y = Intercept_pct_change), size = 5) + 
    geom_errorbar(aes(
      x = .data[[xvar]],
      ymin = Intercept_Lower_pct_change,
      ymax = Intercept_Upper_pct_change
    ), lwd = 1.5, width = .2) +
    geom_hline(yintercept = 0, color = "black", size = 1.5, alpha = 0.4) +
    geom_text(aes(
      x = .data[[xvar]],
      y = Intercept_Upper_pct_change + 15,
      label = paste0(n_obs, " (", n_study, ")")
    ), vjust = .5, size = 4) +
    theme_classic2() +
    xlab(xlabel) + ylab("Effect Size (%)") + 
    theme(
      axis.title.x = element_text(size = 15),
      axis.text.x = element_text(size = 15),
      axis.title.y = element_text(size = 15),
      axis.text.y = element_text(size = 15),
      strip.text = element_text(size = 15),
      panel.border = element_rect(colour = "black", fill = NA, linewidth = .1)
    )
}



```

